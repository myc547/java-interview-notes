# Hazelcast 面试题

## 题目
## 2. Hazelcast数据结构？
## 3. Hazelcast分布式特性？
## 4. Hazelcast与Redis对比？
## 5. Hazelcast使用场景？

更多题目请查看答案文件

## 答案

**题目：**
Hazelcast是什么？

**答案：**
**Hazelcast定义：**
开源的分布式内存计算平台，提供分布式数据结构、缓存、消息队列等功能。

**特点：**
- 内存计算（In-Memory Computing）
- 分布式
- 高可用
- 嵌入式
- 自动分片

**核心功能：**
```
分布式Map
分布式Set/List
分布式Queue
分布式Topic
分布式锁
分布式计算（MapReduce）
分布式服务
```

**基本使用：**
```java
// 创建集群
Config config = new Config();
HazelcastInstance hazelcast = 
    Hazelcast.newHazelcastInstance(config);

// 获取分布式Map
IMap<String, User> users = 
    hazelcast.getMap("users");

// 操作
users.put("1", new User("张三", 20));
User user = users.get("1");
```

---

## 2. Hazelcast数据结构？

**题目：**
Hazelcast支持哪些数据结构？

**答案：**
**1. IMap（分布式Map）**
```java
IMap<String, User> map = hazelcast.getMap("users");

// 基本操作
map.put("key", value);
map.get("key");
map.remove("key");

// 分布式查询
Collection<User> users = map.values(
    Predicates.greaterEqual("age", 18));
```

**2. IQueue（分布式Queue）**
```java
IQueue<String> queue = hazelcast.getQueue("tasks");

queue.offer("task1");
String task = queue.poll();  // 阻塞
String task = queue.poll(10, TimeUnit.SECONDS);
```

**3. ITopic（分布式消息）**
```java
ITopic<String> topic = hazelcast.getTopic("notifications");

// 发布
topic.publish("Hello");

// 订阅
MessageListener<String> listener = msg -> {
    System.out.println("Received: " + msg.getMessageObject());
};
topic.addMessageListener(listener);
```

**4. ISet/IList**
```java
ISet<String> set = hazelcast.getSet("mySet");
IList<String> list = hazelcast.getList("myList");
```

**5. MultiMap（多值Map）**
```java
MultiMap<String, String> multimap = 
    hazelcast.getMultiMap("user-emails");
multimap.put("user1", "email1@163.com");
multimap.put("user1", "email2@qq.com");
```

**6. ReplicatedMap（同步复制Map）**
```java
ReplicatedMap<String, String> map = 
    hazelcast.getReplicatedMap("replicated-data");
```

---

## 3. Hazelcast分布式特性？

**题目：**
Hazelcast有哪些分布式特性？

**答案：**
**1. 数据分片（Partitioning）**
```
数据自动分片
默认271个分区
均匀分布到集群节点
```

**2. 副本（Replication）**
```
每个分区有备份
节点故障，副本接管
保证高可用
```

**3. 分布式锁**
```java
ILock lock = hazelcast.getLock("myLock");

lock.lock();
try {
    // 业务逻辑
} finally {
    lock.unlock();
}

// 尝试获取
if (lock.tryLock(10, TimeUnit.SECONDS)) {
    try {
        // 业务逻辑
    } finally {
        lock.unlock();
    }
}
```

**4. 分布式事务**
```java
TransactionContext context = 
    hazelcast.newTransactionContext();

context.beginTransaction();

TransactionalMap<String, String> map = 
    context.getMap("map");
TransactionalQueue<String> queue = 
    context.getQueue("queue");

map.put("key", "value");
queue.offer("item");

context.commitTransaction();
```

**5. 分布式计算**
```java
// MapReduce
IMap<String, User> users = hazelcast.getMap("users");

Map<String, Integer> result = users
    .aggregate(
        // Mapper
        new MapperEntryClass<User, String, Integer>() {
            public void mapEntry(String key, User user, 
                                Collector<String, Integer> out) {
                out.emit(user.getCity(), 1);
            }
        },
        // Combiner
        new SumCombinerFactory<>(),
        // Reducer
        new SumReducerFactory<>()
    );
```

---

## 4. Hazelcast与Redis对比？

**题目：**
Hazelcast和Redis有什么区别？

**答案：**
**对比表格：**

| 特性 | Hazelcast | Redis |
|------|-----------|-------|
| **部署模式** | 嵌入式/独立 | 独立部署 |
| **数据结构** | 丰富（Map/Queue/Topic等） | 丰富 |
| **分布式计算** | 原生支持 | 需Lua/Module |
| **事务** | 支持XA事务 | 有限 |
| **客户端** | Java为主 | 多语言 |
| **集群** | 自动发现/分片 | Redis Cluster |
| **内存管理** | 堆内/堆外 | 堆内 |
| **适用场景** | 嵌入式应用 | 独立缓存服务 |

**选择建议：**
```
Hazelcast：
- 应用内嵌缓存
- 需要分布式计算
- Java应用

Redis：
- 独立缓存服务
- 多语言客户端
- 简单KV场景
```

---

## 5. Hazelcast使用场景？

**题目：**
Hazelcast适合什么场景？

**答案：**
**典型场景：**

**1. 分布式缓存**
```java
// 应用内嵌缓存
Config config = new Config();
config.getMapConfigs().put("myCache",
    new MapConfig()
        .setTimeToLiveSeconds(3600)
        .setMaxIdleSeconds(1800));

IMap<Object, Object> cache = 
    hazelcast.getMap("myCache");
```

**2. 分布式锁**
```java
// 分布式锁服务
ILock lock = hazelcast.getLock("resource-lock");
```

**3. 分布式消息**
```java
// 发布订阅
ITopic<String> topic = hazelcast.getTopic("events");
topic.publish("event-data");
```

**4. 分布式会话**
```java
// Web会话共享
Map<String, HttpSession> sessions = 
    hazelcast.getMap("http-sessions");
```

**5. 分布式计数器**
```java
// 原子计数器
IHazelcastInstance hazelcast = ...;
IAtomicLong counter = hazelcast.getIAtomicLong("counter");
counter.incrementAndGet();
```

**6. 微服务数据共享**
```
服务间共享状态
减少数据库压力
```

---

*更多Hazelcast面试题答案*
